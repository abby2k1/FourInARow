@page
@model Team9.Connect4.WebUI.Pages.SettingsModel
@{
    ViewData["Title"] = "Settings";
}
<body>
    <div class="text-center">
        <h1 class="display-4">Settings</h1>

        <p>Player ID: @Model.PlayerId</p>

        <form method="post" asp-action="SaveSettings">
            <div class="floatContainer">
                <div class="containerLeft">
                    <p class="lblBoardColor">
                        Pick a Board Color:
                    </p>
                </div>
                <div class="containerRight">
                    <input type="color" id="colorPickerBoard" name="BoardColor" />
                </div>
            </div>

            <br />

            <div class="floatContainer">
                <div class="containerLeft">
                    <p class="lblPlayerColor">
                        Pick Your Color:
                    </p>
                </div>
                <div class="containerRight">
                    <input type="color" id="colorPickerPlayer" name="PlayerColor" />
                </div>
            </div>

            <br />

            <div class="floatContainer">
                <div class="containerLeft">
                    <p class="lblOpponentColor">
                        Pick Opponents Color:
                    </p>
                </div>
                <div class="containerRight">
                    <input type="color" id="colorPickerOpponent" name="OpponentColor" />
                </div>
            </div>

            <br />

            <button type="submit" onclick="saveSettings()">Save</button>
        </form>

        <div class="container">
            <button class="btn" id="btnHome">
                <a asp-page="/Index">Back to Home</a>
            </button>
        </div>
    </div>
    <script>
        function saveSettings() {
            // Getting values of the elements that contain the settings data
            var boardColor = document.getElementById("boardColor").value;
            var playerColor = document.getElementById("playerColor").value;
            var opponentColor = document.getElementById("opponentColor").value;

            // Object to hold the settings data
            var settingsData = {
                boardColor: boardColor,
                playerColor: playerColor,
                opponentColor: opponentColor
            };

            // API request to save the settings
            fetch('/SettingController/Post', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(settingsData)
            }).then(function(response) {
                if (response.ok) {
                    // Handle success
                    window.locaiton.href = '/Settings';
                } else {
                    // Handle failure
                    response.text().then(function(errorMessage) {
                        // Displays/handles error
                        console.error(errorMessage);
                    });
                }
            }).catch(function(error) {
                // Display/handle error
                console.error(error);
            });
        }
    </script>
</body>